<!doctype html>
<!--
    cube.html - Demonstrates rendering and animation of simple cube objects

    
-->
<html xmlns="http://www.w3.org/1999/hmtl" lang="en">
<head>
  <title>My Bitchin Rubiks Cube</title>
  <meta charset="UTF-8"/>
  <style type="text/css">
    canvas { background: blue; }
  </style>

  <script id="vertex-shader" type="x-shader/x-vertex">
attribute vec4 vPosition; // vert attribs bound to array buffer data 
attribute vec4 vColor; // vert attribs bound to array buffer data
attribute vec4 vNormal; // vert normal attribs 

varying vec4 color; // sent down to later stages of the pipeline

uniform mat4 projection; // projection matrix passed from the app
uniform mat4 camera; // camera transformation
uniform mat4 modeltransform; // per-object transform passed from the app


uniform vec4 ambientProduct, diffuseProduct, specularProduct;
uniform vec4 lightPosition;
uniform vec4 lightPosition2;
uniform float shininess;
//put everything in fragment shaderslideset 22

varying highp vec3 vLighting;
    
void main() 
{
        vec3 pos = (modeltransform * vPosition).xyz; //directional?
        vec3 light = lightPosition.xyz;
        vec3 L = normalize(light -pos);
        
        vec3 E = normalize(-pos);
        vec3 H = normalize(L+E);
        vec3 N = normalize((modeltransform*vNormal).xyz);
        vec4 ambient = ambientProduct;
        float Kd = max( dot(L,H), 0.0); //N instead of H?
        vec4 diffuse = Kd*diffuseProduct;
        float Ks = pow( max(dot(N,H),0.0), shininess);
        vec4 specular = Ks * specularProduct;
        
        if( dot(L, N) < 0.0 ) {
        specular = vec4(0, 0, 0, 0); // check slide
    } 
        pos = (modeltransform * vPosition).xyz; //directional?
        light = lightPosition2.xyz;
        L = normalize(light -pos);
        
        E = normalize(-pos);
        H = normalize(L+E);
        N = normalize((modeltransform*vNormal).xyz);
        vec4 ambient2 = ambientProduct;
        Kd = max( dot(L,H), 0.0); //N instead of H?
        vec4 diffuse2 = Kd*diffuseProduct;
        Ks = pow( max(dot(N,H),0.0), shininess);
        vec4 specular2 = Ks * specularProduct;
        
        if( dot(L, N) < 0.0 ) {
        specular2 = vec4(0.5, 0.5, 0.5, 0.5);
    }
    /*
        highp vec3 directionalLightColor = vec3(0.5, 0.5, 0.75);
        highp vec3 directionalVector = vec3(0.85, 0.8, 0.75 );
        highp vec3 ambientLight = vec3(0.6, 0.6, 0.6);
        highp float directional = max(dot(pos, directionalVector), 0.0);
        vLighting = ambientLight + (directionalLightColor * directional); 
    */
    // some per-object matrix ops now done at app level
    // but final matrix chain is processed here
    // It is posible to multiply a lookAt function in here, but i have not been able to get it to work yet. 
        gl_Position = projection *camera* modeltransform * vPosition ;
  //color = vColor;  
    
    //color = ambient+ diffuse +specular + vColor;
    //plus specular makes it bright 
    color =  specular+ diffuse + vColor;
    color.a = 1.0;  
}
  </script>

  <script id="fragment-shader" type="x-shader/x-fragment">
#ifdef GL_ES
precision highp float;
#endif

varying vec4 color;

void
main()
{
    gl_FragColor = color;
}
  </script>

  <script type="text/javascript" src="../Common/webgl-utils.js"></script>
  <script type="text/javascript" src="../Common/initShaders.js"></script>
  <script type="text/javascript" src="../Common/MV.js"></script>
  <script type="text/javascript" src="initGL.js"></script>
  <script type="text/javascript" src="cube.js"></script>
  <script type="text/javascript" src="rubiksfunctions.js"></script>
  <script type="text/javascript" src="filereader.js"></script> 
  <script type="text/javascript" src="animation.js"></script>



</head>
<body style="background-color:black;text-align:center;">
    <canvas id="gl-canvas" width="1024" height="768">Oops ...
        your browser doesn't support the HTML5 canvas element</canvas>
    <div>
        
        <button id = "Btn_OV">Normal View</button>
        <button id = "Btn_PV">Bottom Back View</button>
                    
               
        <button id = "Btn_Ani">Animate Solution</button>
        
         <p style="color:white";align="left">Use this button to select a Cube
        <input type="file" id="cubeinput" />
      </p>
        <p style="color:white";align="right">Use this button to select Solution
        <input type="file" id="solinput" />        
        </p>
    
    </div>
</body>
</html>